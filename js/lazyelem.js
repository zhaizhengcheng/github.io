!function(a,b){"use strict";var c,d,e=b(a),f=!1,g=[],h=[],i={timeout:10,buffer:100,loadingClass:"lazy-loading",srcValue:"lazy-src",bgValue:"lazy-bg"},j={_init:function(){c=this},listen:function(a,d,e){var j,k=b(a||"img["+i.srcValue+"]"),l=d||"img";e&&(j=h.push(e)-1),k.each(function(){var a=b(this);g.push({type:l,obj:a,callback:e?h[j]:null}),a.addClass(i.loadingClass)}),f||c._startListen(),c.detect()},_startListen:function(){e.bind("scroll.lazyelem",function(){clearTimeout(d),d=setTimeout(function(){c.detect()},i.timeout)}),e.bind("resize.lazyelem",function(){c.detect()}),f=!0},detect:function(){for(var a=0;a<g.length;a++){var b=g[a],d=b.obj;if(!d.is(":hidden")&&c._isInScreen(d)){switch(b.type){case"fn":break;case"img":d.attr("src",d.attr(i.srcValue)).removeAttr(i.srcValue);break;case"bg":d.css("background-image","url("+d.attr(i.bgValue)+")").removeAttr(i.bgValue);break;case"dom":var f=d.children("script");f.replaceWith(c._minHtml(f.html()))}b.callback&&b.callback(d),d.removeClass(i.loadingClass),g.splice(a--,1)}}0===g.length&&e.unbind("scroll.lazyelem resize.lazyelem")},_isInScreen:function(a){var b=e.height(),c=e.scrollTop(),d=a.height(),f=a.offset().top;return f+d>c-i.buffer&&f<c+b+i.buffer},_minHtml:function(a){var b=/\n+/g,c=/<!--.*?-->/gi,d=/\/\*.*?\*\//gi,e=/[ ]+</gi;return a=a.replace(b,""),a=a.replace(c,""),a=a.replace(d,""),a=a.replace(e,"<")},config:function(a){b.extend(i,a)}};j._init(),a.lazyelem=j}(window,jQuery);
